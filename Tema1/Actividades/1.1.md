# Actividad 1: Instalación de Apache

[Readme Tema 1](/Tema1/readme.md)

&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;
[Actividad siguiente](1.2.md)

---

## 1 Instalación de Apache

Para instalar Apache en Ubuntu, primero tendremos que tener instalado el Sistema Operativo de Ubuntu.

``` cmd
sudo apt-get update
```
![](res/1.1/1.png)

``` cmd
sudo apt-get install apache2
```

![](res/1.1/2.png)

Una vez que la instalación se complete, deberá ajustar la configuración de su firewall para permitir tráfico HTTP y HTTPS.
UFW tiene diferentes perfiles de aplicaciones que puede aprovechar para hacerlo.
Para enumerar todos los perfiles de aplicaciones de UFW disponibles, puede ejecutar lo siguiente:

``` cmd
sudo ufw app list
```

![](res/1.1/3.png)

> **Apache**: este perfil abre solo el puerto 80 (tráfico web normal no cifrado).
>
> **Apache Full**: este perfil abre los puertos 80 (tráfico web normal no cifrado) y 443 (tráfico TLS/SSL cifrado).
>
> **Apache Secure**: este perfil abre solo el puerto 443 (tráfico TLS/SSL cifrado).

Por ahora, es mejor permitir conexiones únicamente en el puerto 80, ya que se trata de una instalación nueva de Apache y todavía no tiene un certificado TLS/SSL configurado para permitir tráfico HTTPS en su servidor.

Para permitir tráfico únicamente en el puerto 80 utilice el perfil Apache:

``` cmd
sudo ufw allow in "Apache"
```

![](res/1.1/4.png)

Activaremos el Firewall

``` cmd
sudo ufw enable
```

![](res/1.1/5.png)

Comprobamos el estado

``` cmd
sudo ufw status
```

![](res/1.1/6.png)

> Ahora, se permite el tráfico en el puerto 80 a través del firewall.

Podremos comprobar que todo se ha instalado correctamente si accedemos al navegador y buscamos la ip '`127.0.0.1`, nos aparecerá la web por defecto de Apache.

![](res/1.1/7.png)

---

## 2 Instalación de MySQL

Ahora que dispone de un servidor web funcional, deberá instalar un sistema de base de datos para poder almacenar y gestionar los datos de su sitio. MySQL es un sistema de administración de bases de datos popular que se utiliza en entornos PHP.

Una vez más, utilice apt para adquirir e instalar este software:

``` cmd
sudo apt install mysql-server
```
![](res/1.1/8.png)

Cuando la instalación se complete, se recomienda ejecutar una secuencia de comandos de seguridad que viene preinstalada en MySQL Con esta secuencia de comandos se eliminarán algunos ajustes predeterminados poco seguros y se bloqueará el acceso a su sistema de base de datos. Inicie la secuencia de comandos interactiva ejecutando lo siguiente:

``` cmd
sudo mysql_secure_installation
```

![](res/1.1/9.png)

Se le preguntará si desea configurar el `VALIDATE PASSWORD PLUGIN`.
<br>Elige `Y` para indicar que si.

Se le solicitará que seleccione un nivel de validación de contraseña.
<br>
Elegiremos la opción más insegura ya que solo haremos pruebas.

![](res/1.1/10.png)

Para el resto de las preguntas, presione `Y` y `ENTER` en cada mensaje.

Con esto, se eliminarán algunos usuarios anónimos y la base de datos de prueba, se deshabilitarán las credenciales de inicio de sesión remoto de root y se cargarán estas nuevas reglas para que MySQL aplique de inmediato los cambios que realizó.

Cuando termine, compruebe si puede iniciar sesión en la consola de MySQL al escribir lo siguiente:

``` cmd
sudo mysql
```

![](res/1.1/11.png)

Esto permitirá establecer conexión con el servidor de MySQL como root user de la base de datos administrativa, lo que se infiere del uso de sudo cuando se ejecuta este comando.

Para salir pondremos `exit`

---

## 2 Instalación de PHP

Ahora que tenemos instalado apache y mysql para almacenar y gestionar datos, instalaremos php el cual es el lenguaje de programación que se utiliza para crear sitios web dinámicos.

Para instalar estos paquetes, ejecute lo siguiente:

``` cmd
sudo apt install php libapache2-mod-php php-mysql
```

![](res/1.1/12.png)

Una vez que la instalación se complete, podrá ejecutar el siguiente comando para confirmar su versión de PHP:

``` cmd
php -v
```

![](res/1.1/13.png)

## 2 Creación del Host Virtual

Ubuntu 20.04 tiene habilitado un bloque de servidor por defecto, que está configurado para proporcionar documentos del directorio `/var/www/html`.

Si bien esto funciona bien para un solo sitio, puede ser difícil de manejar si aloja varios.

En lugar de modificar `/var/www/html`, crearemos una estructura de directorio dentro de `/var/www` para el sitio your_domain y dejaremos `/var/www/html` establecido como directorio predeterminado que se presentará si una solicitud de cliente no coincide con ningún otro sitio.

Cree el directorio para your_domain de la siguiente manera:

``` cmd
sudo mkdir /var/www/your_domain
```

![](res/1.1/14.png)